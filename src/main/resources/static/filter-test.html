<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ìš”ê¸ˆì œ í•„í„° í…ŒìŠ¤íŠ¸</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; line-height: 1.6; }
        .container { max-width: 800px; margin: 20px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        fieldset { border: 1px solid #ccc; border-radius: 5px; margin-bottom: 20px; padding: 15px; }
        legend { font-weight: bold; font-size: 1.1em; padding: 0 10px; }
        label { margin-right: 15px; display: inline-block; cursor: pointer; }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; }
        button { font-size: 1em; padding: 10px 20px; cursor: pointer; background-color: #007bff; color: white; border: none; border-radius: 5px; }
        button:hover { background-color: #0056b3; }
        #results-container { margin-top: 20px; }
        #resultList { list-style-type: none; padding-left: 0; }
        #resultList li { background-color: #f8f9fa; border: 1px solid #dee2e6; margin-top: -1px; padding: 12px; }
        pre { background-color: #e9ecef; padding: 15px; border-radius: 5px; white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“¦ ìš”ê¸ˆì œ í•„í„°</h2>
    <form id="filterForm">
        <fieldset>
            <legend>ì¹´í…Œê³ ë¦¬</legend>
            <div class="grid-container">
                <label><input type="checkbox" name="category" value="1"> 5G ì‹œê·¸ë‹ˆì²˜</label>
                <label><input type="checkbox" name="category" value="2"> 5G í”„ë¦¬ë¯¸ì–´</label>
                <label><input type="checkbox" name="category" value="3"> 5G ìŠ¤í˜ì…œ</label>
                <label><input type="checkbox" name="category" value="4"> ìœ ìŠ¤</label>
                <label><input type="checkbox" name="category" value="5"> ì‹œë‹ˆì–´</label>
            </div>
            <hr>
            <label><input type="checkbox" id="allCategories"> <strong>ì „ì²´ ì¹´í…Œê³ ë¦¬</strong></label>
        </fieldset>

        <fieldset>
            <legend>ìš”ê¸ˆ ë²”ìœ„</legend>
            <div class="grid-container">
                <label><input type="checkbox" name="price" value="~5"> ~5ë§Œì›ëŒ€</label>
                <label><input type="checkbox" name="price" value="6~8"> 6~8ë§Œì›ëŒ€</label>
                <label><input type="checkbox" name="price" value="9~"> 9ë§Œì›ëŒ€~</label>
            </div>
            <hr>
            <label><input type="checkbox" id="anyPrice"> <strong>ê°€ê²© ìƒê´€ì—†ìŒ</strong></label>
        </fieldset>

        <fieldset>
            <legend>ë°ì´í„°</legend>
            <div class="grid-container">
                <label><input type="checkbox" name="data" value="small"> ì†Œìš©ëŸ‰</label>
                <label><input type="checkbox" name="data" value="large"> ëŒ€ìš©ëŸ‰/ë¬´ì œí•œ</label>
            </div>
            <hr>
            <label><input type="checkbox" id="anyData"> <strong>ë°ì´í„° ìƒê´€ì—†ìŒ</strong></label>
        </fieldset>

        <fieldset>
            <legend>í˜œíƒ</legend>
            <div class="grid-container">
                <label><input type="checkbox" name="benefit" value="3"> VVIP</label>
                <label><input type="checkbox" name="benefit" value="6"> ìŠ¤ë§ˆíŠ¸ê¸°ê¸°</label>
                <label><input type="checkbox" name="benefit" value="7"> ì½˜í…ì¸ </label>
                <label><input type="checkbox" name="benefit" value="8"> êµ¬ë…</label>
            </div>
            <hr>
            <label><input type="checkbox" id="noBenefits"> <strong>í˜œíƒ í•„ìš”ì—†ìŒ</strong></label>
        </fieldset>

        <button type="button" onclick="submitFilter()">ğŸ” ê²€ìƒ‰</button>
    </form>

    <div id="results-container">
        <h3>â–¶ï¸ ìš”ì²­ Body:</h3>
        <pre id="requestBodyPreview">ìš”ì²­ ëŒ€ê¸° ì¤‘...</pre>
        <h3>ğŸ“‹ ê²€ìƒ‰ ê²°ê³¼:</h3>
        <ul id="resultList"></ul>
    </div>
</div>

<script>
    // 'ì „ì²´' ë˜ëŠ” 'ìƒê´€ì—†ìŒ' ì„ íƒ ì‹œ ë‹¤ë¥¸ ì˜µì…˜ ì œì–´
    $(document).ready(function() {
        $('#allCategories').change(function() {
            $('input[name="category"]').prop('disabled', this.checked);
        });
        $('#anyPrice').change(function() {
            $('input[name="price"]').prop('disabled', this.checked);
        });
        $('#anyData').change(function() {
            $('input[name="data"]').prop('disabled', this.checked);
        });
        $('#noBenefits').change(function() {
            $('input[name="benefit"]').prop('disabled', this.checked);
        });
    });

    function submitFilter() {
        const requestBody = {
            categoryIds: [],
            allCategoriesSelected: $('#allCategories').is(':checked'),
            priceRanges: [],
            anyPriceSelected: $('#anyPrice').is(':checked'),
            dataOptions: [],
            anyDataSelected: $('#anyData').is(':checked'),
            benefitIds: [],
            noBenefitsSelected: $('#noBenefits').is(':checked')
        };

        // ì¹´í…Œê³ ë¦¬ ID ìˆ˜ì§‘
        if (!requestBody.allCategoriesSelected) {
            $('input[name="category"]:checked').each(function() {
                requestBody.categoryIds.push(parseInt($(this).val()));
            });
        }

        // ê°€ê²© ë²”ìœ„ ìˆ˜ì§‘
        if (!requestBody.anyPriceSelected) {
            $('input[name="price"]:checked').each(function() {
                requestBody.priceRanges.push($(this).val());
            });
        }

        // ë°ì´í„° ì˜µì…˜ ìˆ˜ì§‘
        if (!requestBody.anyDataSelected) {
            $('input[name="data"]:checked').each(function() {
                requestBody.dataOptions.push($(this).val());
            });
        }

        // í˜œíƒ ID ìˆ˜ì§‘
        if (!requestBody.noBenefitsSelected) {
            $('input[name="benefit"]:checked').each(function() {
                requestBody.benefitIds.push(parseInt($(this).val()));
            });
        }

        // ìš”ì²­ Bodyë¥¼ í™”ë©´ì— í‘œì‹œ
        $('#requestBodyPreview').text(JSON.stringify(requestBody, null, 2));

        // AJAX ìš”ì²­
        $.ajax({
            url: 'http://localhost:8084/plan/filter',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(requestBody),
            success: function(response) {
                const resultList = $('#resultList');
                resultList.empty();
                if (!response || response.length === 0) {
                    resultList.append('<li>ì¡°ê±´ì— ë§ëŠ” ìš”ê¸ˆì œê°€ ì—†ìŠµë‹ˆë‹¤.</li>');
                    return;
                }
                response.forEach(plan => {
                    const fee = plan.monthlyFee ? plan.monthlyFee.toLocaleString() : 'N/A';
                    const category = plan.categoryName ? ` (${plan.categoryName})` : '';
                    resultList.append(`<li>${plan.planName}${category} - ${fee}ì›</li>`);
                });
            },
            error: function(xhr) {
                const resultList = $('#resultList');
                resultList.empty();
                resultList.append(`<li>ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${xhr.status} ${xhr.statusText}</li>`);
                console.error("Error:", xhr.responseText);
            }
        });
    }
</script>

</body>
</html>